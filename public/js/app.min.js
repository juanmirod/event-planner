!function(e){"use strict";e.module("planner",["ngRoute","ngAnimate","ui.bootstrap.collapse","ui.bootstrap.tpls","planner.login","planner.signup","planner.home","planner.event","planner.directives","firebase","firebaseAPI"]).run(["$rootScope","$location",function(e,t){e.$on("$routeChangeError",function(e,n,r,o){"AUTH_REQUIRED"===o&&t.path("/")})}]).config(["$locationProvider","$routeProvider",function(e,t){e.hashPrefix("!"),t.otherwise({redirectTo:"/"})}]).controller("AppController",["$rootScope","$scope","$location","Auth","Users",function(e,t,n,r,o){t.auth=r,t.$location=n,t.isCollapsed=!0,t.auth.$onAuthStateChanged(function(e){e?(t.firebaseUser=e,o.get(e.uid).$loaded(function(e){t.firebaseUser.name=e.name,t.firebaseUser.bio=e.bio})):t.firebaseUser=void 0}),t.$on("$routeChangeStart",function(){t.isCollapsed=!0})}])}(window.angular),function(){"use strict";var e={apiKey:"AIzaSyBLdzEKg3XtsvI0JaXL1wTiW7hdxDkrzWU",authDomain:"udacity-event-planner-7ce8e.firebaseapp.com",databaseURL:"https://udacity-event-planner-7ce8e.firebaseio.com",storageBucket:"udacity-event-planner-7ce8e.appspot.com"};firebase.initializeApp(e),angular.module("firebaseAPI",[]).constant("FirebaseUrl","https://udacity-event-planner-7ce8e.firebaseio.com").service("RootRef",function(){return firebase.database().ref()}).service("Users",["RootRef","$firebaseArray","$firebaseObject",function(e,t,n){var r=e.child("users");this.list=t(r),this.get=function(e){return n(r.child(e))},this.newUser=function(e){return r.child(e)}}]).service("Events",["RootRef","$firebaseArray","$firebaseObject",function(e,t,n){var r=e.child("events");this.list=t(r),this.get=function(e){return n(r.child(e))}}]).factory("Auth",["$firebaseAuth",function(e){return e()}])}(),function(e){"use strict";e.module("planner.validators",[]).directive("password",function(){return{require:"ngModel",link:function(e,t,n,r){r.$validators.password=function(t,n){e.passwordErrorMessages=[],e.valid=!0;var o=function(t){e.passwordErrorMessages.push(t)};if(r.$isEmpty(t))return o("This field is required"),!1;n.match(/[^A-z0-9\\!\\@\\#\\$\\%\\^\\&\\*]/)&&(o("The password constains illegal characters."),e.valid=!1),(n.length<10||n.length>100)&&(o("The password must be between 10 and 100 characters long."),e.valid=!1);var a=[["[\\!\\@\\#\\$\\%\\^\\&\\*]","It must contain at least one of this symbols: !@#$%^&*"],["\\d","It must contain a number"],["[a-z]","It must contain a lowercase character"],["[A-Z]","It must contain an uppercase character"]];return a.forEach(function(t){var r=new RegExp(t[0],"g");r.test(n)||(o(t[1]),e.valid=!1)}),e.valid}}}})}(window.angular),function(e){"use strict";e.module("planner.directives",["ngMap"]).constant("GeolocationKey","AIzaSyA9i-zj4Bpd8cox_jkeiLiJtY5nGWxJZZ0").directive("formProgressbar",[function(){return{restrict:"E",scope:{width:"=",field:"="},templateUrl:"public/js/components/progressbar.html"}}]).directive("autofocus",[function(){return{restrict:"A",link:function(e,t){t[0].focus()}}}]).directive("locationinput",["$http","GeolocationKey","NgMap",function(e,t,n){return{restrict:"E",templateUrl:"public/js/components/locationinput.html",controller:["$scope",function(r){function o(n,o){e.get("https://maps.googleapis.com/maps/api/geocode/json",{params:{latlng:[n,o].join(","),key:t}}).then(function(e){"undefined"!=typeof e.data.results[0]&&(r.event.location=e.data.results[0].formatted_address,r.located=!0,r.map.setCenter({lat:parseFloat(n),lng:parseFloat(o)}))}).catch(function(e){r.event.location="There was an error checking this location: "+e.statusText})}r.triedLocation=!1,n.getMap().then(function(e){r.map=e}),r.getLocation=function(){navigator.geolocation&&!r.triedLocation&&(r.triedLocation=!0,navigator.geolocation.getCurrentPosition(function(e){o(e.coords.latitude,e.coords.longitude)},function(e){r.event.location="Sorry, but we couldn't get your location: "+e.message,r.$apply()}))},r.locationChangedHandler=function(){if(this.position){var e=/-?\d+\.\d+/g,t=this.position.toString().match(e);o(t[0],t[1])}else r.place=this.getPlace(),r.map.setCenter(r.place.geometry.location)}}]}}])}(window.angular),function(e){"use strict";e.module("planner.event",["ngRoute","firebase","firebaseAPI"]).constant("EventTypes",[{name:"Conference",icon:"glyphicon-user"},{name:"Company Meet-up",icon:"glyphicon-user"},{name:"Sport event",icon:"glyphicon-flag"},{name:"Birthday Party",icon:"glyphicon-gift"},{name:"Wedding",icon:"glyphicon-heart"},{name:"Newborn party",icon:"glyphicon-baby-formula"},{name:"Pokemon Championship",icon:"glyphicon-star"}]).config(["$routeProvider",function(e){e.when("/create",{templateUrl:"public/js/views/event/event_form.html",controller:"CreateCtrl",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]}}),e.when("/edit/:ref",{templateUrl:"public/js/views/event/event_form.html",controller:"CreateCtrl",resolve:{currentAuth:["Auth",function(e){return e.$requireSignIn()}]}})}]).controller("CreateCtrl",["$scope","Events","$route","$timeout","currentAuth","EventTypes",function(e,t,n,r,o,a){function i(n){var r=t.get(n);e.event=r,e.saveDisabled=!0,r.$loaded().then(function(t){e.saveDisabled=!1,e.event._start_date_form=new Date(e.event.start_date),e.event._end_date_form=new Date(e.event.end_date)})}function s(){e.event.created_at=Date.now(),e.event.created_by=o.uid,t.list.$add(e.event).then(function(t){e.saveDisabled=!0,e.infoMessage="Event saved successfully! You can see it on the events list now.",e.ref=t.key,i(t.key),r(e.continueEditing,2e3)}).catch(function(t){e.errorMessage="There was an error trying to create the event: "+t.message})}function c(){e.event.$save().then(function(t){e.saveDisabled=!0,e.infoMessage="Event saved successfully!",r(e.continueEditing,1e3)}).catch(function(t){e.errorMessage="There was an error trying to update the event: "+t.message})}e.event={},e.eventTypes=a,"undefined"!=typeof n.current.params.ref&&(e.ref=n.current.params.ref,i(e.ref)),e.eventIcon=function(e){var t="glyphicon-map-marker";return a.some(function(n){if(n.name==e.type)return t=n.icon,!0}),t},e.checkDates=function(){e.enddateError=!1,e.startdateError=!1,e.event.start_date=new Date(e.event._start_date_form).getTime(),e.event.end_date=new Date(e.event._end_date_form).getTime(),e.event.start_date<Date.now()&&(e.startdateError=!0),e.event.end_date<e.event.start_date&&(e.enddateError=!0)},e.submitHandler=function(t){t.$valid&&!e.enddateError?(e.event.start_date=new Date(e.event._start_date_form).getTime(),e.event.end_date=new Date(e.event._end_date_form).getTime(),"undefined"!=typeof e.ref?c():s()):e.errorMessage="Please check that all required fields are filled and dates are correctly formatted."},e.continueEditing=function(){e.saveDisabled=!1,e.infoMessage=void 0}}])}(window.angular),function(){"use strict";angular.module("planner.home",["firebaseAPI","ngRoute","ngMap","planner.event"]).config(["$routeProvider",function(e){e.when("/",{templateUrl:"public/js/views/home/home.html",controller:"HomeCtrl",resolve:{currentAuth:["Auth",function(e){return e.$waitForSignIn()}]}})}]).controller("HomeCtrl",["$rootScope","$scope","Events","currentAuth","EventTypes",function(e,t,n,r,o){function a(e,t){return e.start_date<t.start_date?-1:e.start_date>t.start_date?1:0}e.authUser=r,t.toggleMap=function(e){e._showMap?e._showMap=!1:e._showMap=!0},t.userHasCreated=function(e,t){return!(!t||!e.created_by)&&e.created_by==t.uid},t.eventIcon=function(e){var t="glyphicon-map-marker";return o.some(function(n){n.name==e.type&&(t=n.icon)}),t},n.list.sort(a),t.events=n.list,n.list.$watch(function(){n.list.sort(a)})}])}(),function(e){"use strict";e.module("planner.login",["ngRoute","firebaseAPI"]).config(["$routeProvider",function(e){e.when("/login",{templateUrl:"public/js/views/login/login.html",controller:"LoginCtrl",resolve:{currentAuth:["Auth",function(e){return e.$waitForSignIn()}]}})}]).controller("LoginCtrl",["$rootScope","$scope","Auth","$location",function(e,t,n,r){t.email="",t.password="",t.submitHandler=function(e){if(t.error="",e.$valid){var o=n.$signInWithEmailAndPassword(t.email,t.password);o.then(function(e){r.path("/")}).catch(function(e){t.error="Authentication failed: "+e})}}}])}(window.angular),function(e){"use strict";e.module("planner.signup",["ngRoute","planner.validators","firebaseAPI"]).config(["$routeProvider",function(e){e.when("/signup",{templateUrl:"public/js/views/signup/signup.html",controller:"SignupCtrl"})}]).controller("SignupCtrl",["$rootScope","$scope","$location","Auth","Users",function(e,t,n,r,o){t.submitHandler=function(e){e.$valid&&r.$createUserWithEmailAndPassword(t.user.email,t.user.password).then(function(e){return t.firebaseUser=e,o.newUser(e.uid).set({name:t.user.name,bio:t.user.bio||""})}).then(function(e){n.path("/")}).catch(function(e){t.authError="There was an error trying to create the user: "+e.message,"undefined"!=typeof t.firebaseUser&&t.firebaseUser.delete().catch(function(e){t.authError+=e})})}}])}(window.angular);